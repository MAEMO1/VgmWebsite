{% extends "base.html" %}

{% block title %}{{ _('Voeg iftar toe - Ramadan 1445/2024') }}{% endblock %}

{% block content %}
<div class="container py-4">
    <div class="card">
        <div class="card-header">
            <h2 class="card-title mb-0">{{ _('Voeg iftar toe') }}</h2>
        </div>
        <div class="card-body">
            <form method="POST" action="{{ url_for('ramadan.add_iftar') }}">
                <div class="mb-3">
                    <label for="date" class="form-label">{{ _('Datum') }}</label>
                    <input type="date" class="form-control" id="date" name="date" required>
                </div>

                <div class="mb-3">
                    <label for="start_time" class="form-label">{{ _('Starttijd') }}</label>
                    <input type="time" class="form-control" id="start_time" name="start_time" required>
                </div>

                <div class="mb-3">
                    <label for="location" class="form-label">{{ _('Adres') }}</label>
                    <input type="text" class="form-control" id="location" name="location" 
                           value="{% if current_user.is_admin %}{{ current_user.address }}{% endif %}"
                           placeholder="{{ _('Straat en nummer') }}" required>
                </div>

                <div class="mb-3">
                    <label for="max_attendees" class="form-label">{{ _('Maximum aantal deelnemers') }}</label>
                    <input type="number" class="form-control" id="max_attendees" name="max_attendees" min="1">
                    <small class="form-text">{{ _('Laat leeg voor onbeperkte capaciteit') }}</small>
                </div>

                <div class="form-check mb-3">
                    <input type="checkbox" class="form-check-input" id="is_family_friendly" name="is_family_friendly">
                    <label class="form-check-label" for="is_family_friendly">{{ _('Gezinsvriendelijk') }}</label>
                </div>

                <div class="mb-3">
                    <label for="notes" class="form-label">{{ _('Opmerkingen') }}</label>
                    <textarea class="form-control" id="notes" name="notes" rows="3"></textarea>
                    <small class="form-text">{{ _('Extra informatie over het evenement') }}</small>
                </div>

                <div class="text-end">
                    <a href="{{ url_for('ramadan.iftar_map') }}" class="btn btn-secondary">{{ _('Annuleren') }}</a>
                    <button type="submit" class="btn btn-primary">{{ _('Iftar Toevoegen') }}</button>
                </div>
            </form>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    const isRecurring = document.getElementById('is_recurring');
    const recurringOptions = document.getElementById('recurring-options');
    const registrationRequired = document.getElementById('registration_required');
    const registrationOptions = document.getElementById('registration-options');
    const timeType = document.getElementById('time_type');
    const specificTimeContainer = document.getElementById('specific_time_container');
    const prayerTimeContainer = document.getElementById('prayer_time_container');

    // Handle recurring event options (now irrelevant)
    isRecurring.addEventListener('change', function() {
        recurringOptions.style.display = this.checked ? 'block' : 'none';
        if (this.checked) {
            document.getElementById('recurrence_end_date').required = true;
            document.getElementById('recurrence_type').required = true;
        }
    });

    // Handle registration options (now irrelevant)
    registrationRequired.addEventListener('change', function() {
        registrationOptions.style.display = this.checked ? 'block' : 'none';
        if (this.checked) {
            document.getElementById('registration_deadline').required = true;
        }
    });

    // Handle time type selection (now irrelevant)
    timeType.addEventListener('change', function() {
        if (this.value === 'specific') {
            specificTimeContainer.style.display = 'block';
            prayerTimeContainer.style.display = 'none';
            document.getElementById('start_time').required = true;
            document.getElementById('prayer_name').required = false;
        } else {
            specificTimeContainer.style.display = 'none';
            prayerTimeContainer.style.display = 'block';
            document.getElementById('start_time').required = false;
            document.getElementById('prayer_name').required = true;
        }
    });


    // Initialize time type display on page load (now irrelevant)
    timeType.dispatchEvent(new Event('change'));
});
</script>
{% endblock %}