{% extends "base.html" %}

{% block title %}{{ _('Mosques in Ghent') }}{% endblock %}

{% block content %}
<div class="mosque-hero">
    <div class="container">
        <div class="hero-content text-center">
            <h1 class="display-4 mb-4">{{ _('Mosques in Ghent') }}</h1>
            <div class="quote-container">
                <blockquote class="hadith-quote">
                    <p class="quote-text">Wie zich thuis reinigt en daarna naar een van de huizen van Allah loopt om er één van zijn verplichtingen te verrichten, zal voor elke stap die hij zet, een zonde laten vallen en een graad in rang verhogen.</p>
                    <footer class="quote-source">Sahih Muslim 666</footer>
                </blockquote>
            </div>
        </div>
    </div>
</div>

<div class="mosque-content py-5">
    <div class="container">
        <div class="row">
            <!-- Google Maps Container -->
            <div class="col-lg-12 mb-5">
                <div id="mosque-map" class="rounded shadow-sm">
                    <div class="d-flex justify-content-center align-items-center h-100">
                        <div class="spinner-border text-primary" role="status">
                            <span class="visually-hidden">Loading...</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Mosque Grid -->
            <div class="col-12">
                <div class="row g-4">
                    {% for mosque in mosques %}
                    <div class="col-md-6 col-lg-4">
                        <div class="mosque-card" data-lat="{{ mosque.latitude }}" data-lng="{{ mosque.longitude }}">
                            <div class="mosque-image">
                                {% if mosque.mosque_image %}
                                <img src="{{ mosque.mosque_image }}" alt="{{ mosque.mosque_name }}" class="img-fluid">
                                {% else %}
                                <div class="mosque-placeholder">
                                    <i class="fas fa-mosque"></i>
                                </div>
                                {% endif %}
                            </div>
                            <div class="mosque-details">
                                <h3 class="mosque-name">{{ mosque.mosque_name }}</h3>
                                <div class="mosque-address">
                                    <i class="fas fa-map-marker-alt"></i>
                                    <span>{{ mosque.get_full_address() }}</span>
                                </div>
                                {% if mosque.mosque_phone %}
                                <div class="mosque-contact">
                                    <i class="fas fa-phone"></i>
                                    <span>{{ mosque.mosque_phone }}</span>
                                </div>
                                {% endif %}
                                <a href="{{ url_for('main.mosque_detail', mosque_id=mosque.id) }}" class="btn btn-outline-primary mt-3">
                                    {{ _('Meer informatie') }}
                                </a>
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                </div>
            </div>
        </div>
    </div>
</div>

<style>
:root {
    --primary-color: #005A87;
    --secondary-color: #41B7AC;
    --accent-color: #FF4154;
    --background-light: #F8F9FA;
    --text-color: #2C3E50;
    --text-secondary: #6C757D;
    --border-color: #E9ECEF;
}

/* Hero Section */
.mosque-hero {
    background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
    color: white;
    padding: 6rem 0;
    margin-bottom: 2rem;
}

.hero-content {
    max-width: 800px;
    margin: 0 auto;
}

.quote-container {
    background: rgba(255, 255, 255, 0.1);
    backdrop-filter: blur(10px);
    border-radius: 1rem;
    padding: 2rem;
    margin-top: 2rem;
}

.hadith-quote {
    border-left: none;
    padding: 0;
    margin: 0;
}

.hadith-quote p:first-child {
    font-size: 2rem;
    font-weight: 600;
}

.quote-text {
    font-size: 1.2rem;
    line-height: 1.8;
    margin: 1rem 0;
}

.quote-source {
    font-size: 1rem;
    opacity: 0.8;
}

/* Map Styles */
#mosque-map {
    height: 400px;
    width: 100%;
    margin-bottom: 2rem;
}

/* Mosque Cards */
.mosque-card {
    background: white;
    border-radius: 1rem;
    overflow: hidden;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    transition: transform 0.3s ease, box-shadow 0.3s ease;
    height: 100%;
}

.mosque-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 12px rgba(0, 0, 0, 0.15);
}

.mosque-image {
    height: 200px;
    overflow: hidden;
    position: relative;
}

.mosque-image img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.mosque-placeholder {
    width: 100%;
    height: 100%;
    background: var(--background-light);
    display: flex;
    align-items: center;
    justify-content: center;
}

.mosque-placeholder i {
    font-size: 4rem;
    color: var(--primary-color);
    opacity: 0.5;
}

.mosque-details {
    padding: 1.5rem;
}

.mosque-name {
    font-size: 1.25rem;
    font-weight: 600;
    color: var(--text-color);
    margin-bottom: 1rem;
    line-height: 1.4;
}

.mosque-address, .mosque-contact {
    color: var(--text-secondary);
    margin-bottom: 0.5rem;
    display: flex;
    align-items: flex-start;
    gap: 0.5rem;
}

.mosque-address i, .mosque-contact i {
    margin-top: 0.25rem;
}

@media (max-width: 768px) {
    .mosque-hero {
        padding: 4rem 0;
    }

    .quote-container {
        padding: 1.5rem;
    }

    .hadith-quote p:first-child {
        font-size: 1.5rem;
    }

    .quote-text {
        font-size: 1rem;
    }
}
</style>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/maps.js') }}"></script>
<script>
    function handleMapsError() {
        const mapContainer = document.getElementById('mosque-map');
        if (mapContainer) {
            mapContainer.innerHTML = `
                <div class="alert alert-info h-100 d-flex flex-column justify-content-center text-center">
                    <i class="fas fa-map-marked-alt fa-3x mb-3"></i>
                    <h4>{{ _('Map Currently Unavailable') }}</h4>
                    <p class="mb-0">{{ _('You can still view all mosques in the list below.') }}</p>
                </div>
            `;
        }
    }

    function handleScriptError() {
        handleMapsError();
    }
</script>
<script src="https://maps.googleapis.com/maps/api/js?key={{ google_maps_api_key }}&callback=initMap&v=weekly" 
        async 
        defer
        onerror="handleScriptError()"></script>
{% endblock %}