{% extends "base.html" %}

{% block title %}{{ _('Mosques in Ghent') }}{% endblock %}

{% block content %}
<div class="mosque-hero">
    <div class="hero-overlay"></div>
    <div class="hero-pattern"></div>
    <div class="hero-light"></div>
    <div class="container">
        <div class="hero-content text-center">
            <h1 class="display-4 mb-4">{{ _('Mosques in Ghent') }}</h1>
            <div class="quote-container">
                <blockquote class="hadith-quote">
                    <p class="lead-quote">Elke stap, een hogere rang</p>
                    <p class="quote-text">Wie zich thuis reinigt en daarna naar een van de huizen van Allah loopt om er één van zijn verplichtingen te verrichten, zal voor elke stap die hij zet, een zonde laten vallen en een graad in rang verhogen.</p>
                    <footer class="quote-source">Sahih Muslim 666</footer>
                </blockquote>
            </div>
        </div>
    </div>
</div>

<div class="mosque-content py-5">
    <div class="container">
        <div class="row">
            <!-- Google Maps Container -->
            <div class="col-lg-12 mb-5">
                <div id="mosque-map" class="rounded shadow-sm">
                    <div class="d-flex justify-content-center align-items-center h-100">
                        <div class="spinner-border text-primary" role="status">
                            <span class="visually-hidden">Loading...</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Mosque Grid -->
            <div class="col-12">
                <div class="row g-4">
                    {% for mosque in mosques %}
                    <div class="col-md-6 col-lg-4">
                        <div class="mosque-card" data-lat="{{ mosque.latitude }}" data-lng="{{ mosque.longitude }}">
                            <div class="mosque-image">
                                {% if mosque.mosque_image %}
                                <img src="{{ mosque.mosque_image }}" alt="{{ mosque.mosque_name }}" class="img-fluid">
                                {% else %}
                                <div class="mosque-placeholder">
                                    <i class="fas fa-mosque"></i>
                                </div>
                                {% endif %}
                            </div>
                            <div class="mosque-details">
                                <h3 class="mosque-name">{{ mosque.mosque_name }}</h3>
                                <div class="mosque-address">
                                    <i class="fas fa-map-marker-alt"></i>
                                    <span>{{ mosque.get_full_address() }}</span>
                                </div>
                                {% if mosque.mosque_phone %}
                                <div class="mosque-contact">
                                    <i class="fas fa-phone"></i>
                                    <span>{{ mosque.mosque_phone }}</span>
                                </div>
                                {% endif %}
                                <a href="{{ url_for('main.mosque_detail', mosque_id=mosque.id) }}" class="btn btn-outline-primary mt-3">
                                    {{ _('Meer informatie') }}
                                </a>
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                </div>
            </div>
        </div>
    </div>
</div>

{% endblock %}

{% block styles %}
<style>
:root {
    --primary-color: #005A87;
    --secondary-color: #41B7AC;
    --accent-color: #FF4154;
    --gold: #D4AF37;
    --deep-blue: #1B264F;
    --soft-green: #7AB800;
    --background-light: #F8F9FA;
    --text-color: #2C3E50;
    --text-secondary: #6C757D;
    --border-color: #E9ECEF;
}

/* Hero Section */
.mosque-hero {
    background: linear-gradient(135deg, var(--deep-blue), var(--primary-color));
    color: white;
    padding: 8rem 0;
    position: relative;
    overflow: hidden;
    margin-bottom: 2rem;
}

.hero-overlay {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(
        rgba(27, 38, 79, 0.9),
        rgba(27, 38, 79, 0.7)
    );
    z-index: 1;
}

.hero-pattern {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-image: url("data:image/svg+xml,%3Csvg width='100' height='100' viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M50 50l30-30M50 50l-30 30M50 50l30 30M50 50l-30-30' stroke='%23ffffff' stroke-width='0.5' stroke-opacity='0.1' fill='none'/%3E%3C/svg%3E");
    background-size: 50px 50px;
    opacity: 0.1;
    z-index: 2;
}

.hero-light {
    position: absolute;
    top: -50%;
    left: 50%;
    transform: translateX(-50%);
    width: 200%;
    height: 200%;
    background: radial-gradient(
        circle at center,
        rgba(212, 175, 55, 0.15) 0%,
        rgba(212, 175, 55, 0) 70%
    );
    z-index: 3;
    pointer-events: none;
}

.hero-content {
    position: relative;
    z-index: 4;
    max-width: 800px;
    margin: 0 auto;
}

.hero-content h1 {
    font-weight: 700;
    margin-bottom: 2rem;
    text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
    color: var(--gold);
}

.quote-container {
    background: rgba(255, 255, 255, 0.05);
    backdrop-filter: blur(10px);
    border-radius: 1.5rem;
    padding: 3rem;
    margin-top: 2rem;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1),
                inset 0 0 0 1px rgba(255, 255, 255, 0.1);
    border: 1px solid rgba(255, 255, 255, 0.1);
}

.hadith-quote {
    border-left: none;
    padding: 0;
    margin: 0;
}

.lead-quote {
    font-size: 2.5rem;
    font-weight: 300;
    margin-bottom: 2rem;
    line-height: 1.2;
    color: var(--gold);
    text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
    letter-spacing: 0.5px;
}

.quote-text {
    font-size: 1.25rem;
    line-height: 1.8;
    margin-bottom: 1.5rem;
    font-weight: 300;
    color: rgba(255, 255, 255, 0.9);
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
}

.quote-source {
    font-size: 1rem;
    color: var(--gold);
    font-weight: 500;
    font-style: italic;
    opacity: 0.8;
}

/* Map Styles */
#mosque-map {
    height: 400px;
    width: 100%;
    margin-bottom: 2rem;
}

/* Mosque Cards */
.mosque-card {
    background: white;
    border-radius: 1rem;
    overflow: hidden;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    transition: transform 0.3s ease, box-shadow 0.3s ease;
    height: 100%;
}

.mosque-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 12px rgba(0, 0, 0, 0.15);
}

.mosque-image {
    height: 200px;
    overflow: hidden;
    position: relative;
}

.mosque-image img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.mosque-placeholder {
    width: 100%;
    height: 100%;
    background: var(--background-light);
    display: flex;
    align-items: center;
    justify-content: center;
}

.mosque-placeholder i {
    font-size: 4rem;
    color: var(--primary-color);
    opacity: 0.5;
}

.mosque-details {
    padding: 1.5rem;
}

.mosque-name {
    font-size: 1.25rem;
    font-weight: 600;
    color: var(--text-color);
    margin-bottom: 1rem;
    line-height: 1.4;
}

.mosque-address, .mosque-contact {
    color: var(--text-secondary);
    margin-bottom: 0.5rem;
    display: flex;
    align-items: flex-start;
    gap: 0.5rem;
}

.mosque-address i, .mosque-contact i {
    margin-top: 0.25rem;
}

@media (max-width: 768px) {
    .mosque-hero {
        padding: 6rem 0;
    }

    .quote-container {
        padding: 2rem;
        margin-top: 1.5rem;
    }

    .lead-quote {
        font-size: 2rem;
        margin-bottom: 1.5rem;
    }

    .quote-text {
        font-size: 1.1rem;
    }
}
</style>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/maps.js') }}"></script>
<script>
    function handleMapsError() {
        const mapContainer = document.getElementById('mosque-map');
        if (mapContainer) {
            mapContainer.innerHTML = `
                <div class="alert alert-info h-100 d-flex flex-column justify-content-center text-center">
                    <i class="fas fa-map-marked-alt fa-3x mb-3"></i>
                    <h4>{{ _('Map Currently Unavailable') }}</h4>
                    <p class="mb-0">{{ _('You can still view all mosques in the list below.') }}</p>
                </div>
            `;
        }
    }

    function handleScriptError() {
        handleMapsError();
    }
</script>
<script src="https://maps.googleapis.com/maps/api/js?key={{ google_maps_api_key }}&callback=initMap&v=weekly" 
    async 
    defer
    onerror="handleScriptError()"></script>
{% endblock %}