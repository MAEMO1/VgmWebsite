{% extends "base.html" %}

{% block title %}{{ _('Steun VGM') }}{% endblock %}

{% block content %}
<div class="donate-hero">
    <div class="hero-overlay"></div>
    <div class="container">
        <div class="hero-content text-center">
            <h1 class="display-4 mb-4">
                {{ _('Steun VGM') }}
                <span class="bloom-icon">
                    <svg width="32" height="32" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M12 8C13.1 8 14 7.1 14 6C14 4.9 13.1 4 12 4C10.9 4 10 4.9 10 6C10 7.1 10.9 8 12 8Z" fill="currentColor" class="petal petal-1"/>
                        <path d="M16 14C17.1 14 18 13.1 18 12C18 10.9 17.1 10 16 10C14.9 10 14 10.9 14 12C14 13.1 14.9 14 16 14Z" fill="currentColor" class="petal petal-2"/>
                        <path d="M8 14C9.1 14 10 13.1 10 12C10 10.9 9.1 10 8 10C6.9 10 6 10.9 6 12C6 13.1 6.9 14 8 14Z" fill="currentColor" class="petal petal-3"/>
                        <path d="M12 20C13.1 20 14 19.1 14 18C14 16.9 13.1 16 12 16C10.9 16 10 16.9 10 18C10 19.1 10.9 20 12 20Z" fill="currentColor" class="petal petal-4"/>
                        <circle cx="12" cy="12" r="2" fill="currentColor" class="center"/>
                    </svg>
                </span>
            </h1>
            <div class="quote-container">
                <blockquote class="hadith-quote">
                    <p class="lead-quote">{{ _('Samen bouwen aan een sterkere gemeenschap') }}</p>
                    <p class="quote-text">De gelijkenis van degenen die op de Weg van Allah uitgeven is als de gelijkenis van een graankorrel, (die) zeven aren voortbrengt, in iedere aar honderd korrels, en Allah vermenigvuldigt voor wie Hij wil. En Allah is Alomvattend, Alwetend.</p>
                    <footer class="quote-source">Koran 2:261</footer>
                </blockquote>
            </div>
        </div>
    </div>
</div>

<div class="donation-choice-section">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-lg-8">
                <div class="donation-choice-container">
                    <h2 class="text-center mb-4">{{ _('Hoe wilt u bijdragen?') }}</h2>
                    <div class="choice-grid">
                        <button class="choice-option active" data-type="general">
                            <div class="choice-icon">
                                <i class="fas fa-mosque"></i>
                            </div>
                            <div class="choice-content">
                                <h3>{{ _('Steun VGM') }}</h3>
                                <p>{{ _('Steun de diverse activiteiten en projecten van de VGM') }}</p>
                            </div>
                        </button>
                        <button class="choice-option" data-type="project">
                            <div class="choice-icon">
                                <i class="fas fa-hands-helping"></i>
                            </div>
                            <div class="choice-content">
                                <h3>{{ _('Specifiek Project') }}</h3>
                                <p>{{ _('Kies een specifiek project om te steunen') }}</p>
                            </div>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="projectSection" class="campaigns-section" style="display: none;">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-lg-8">
                <div class="projects-widget">
                    <h2 class="widget-title">{{ _('Onze Projecten') }}</h2>
                    <div class="projects-list">
                        {% for campaign in campaigns %}
                        <div class="project-item" data-campaign-id="{{campaign.id}}">
                            <div class="project-header">
                                {% if campaign.image_url %}
                                <div class="project-image">
                                    <img src="{{ campaign.image_url }}" alt="{{ campaign.title }}">
                                </div>
                                {% endif %}
                                <div class="project-main-info">
                                    <span class="project-badge">{{ _('Lopend Project') }}</span>
                                    <h3 class="project-title">{{ campaign.title }}</h3>
                                    <p class="project-description">{{ campaign.description }}</p>
                                </div>
                            </div>
                            <div class="project-progress">
                                <div class="progress-stats">
                                    <div class="progress-stat">
                                        <span class="stat-label">{{ _('Opgehaald') }}</span>
                                        <span class="stat-value progress-amount">€{{ "%.2f"|format(campaign.current_amount) }}</span>
                                    </div>
                                    <div class="progress-stat text-end">
                                        <span class="stat-label">{{ _('Doel') }}</span>
                                        <span class="stat-value">€{{ "%.2f"|format(campaign.goal_amount) }}</span>
                                    </div>
                                </div>
                                <div class="progress">
                                    <div class="progress-bar" role="progressbar"
                                         style="width: {{ campaign.calculate_progress() }}%"
                                         aria-valuenow="{{ campaign.calculate_progress() }}"
                                         aria-valuemin="0"
                                         aria-valuemax="100">
                                    </div>
                                </div>
                                <div class="progress-percentage">{{ "%.1f"|format(campaign.calculate_progress()) }}% van het doel bereikt</div>
                            </div>
                            <button class="btn btn-primary btn-support w-100 mt-3"
                                    onclick="selectCampaign({{ campaign.id }}, '{{ campaign.title }}')">
                                <i class="fas fa-heart me-2"></i>{{ _('Steun dit Project') }}
                            </button>
                        </div>
                        {% endfor %}
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="donation-section">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-lg-8">
                <div class="donation-card">
                    <div class="donation-options mb-4">
                        <h3 class="text-center mb-4" id="donationFormTitle">{{ _('Kies een donatiebedrag') }}</h3>
                        <div class="amount-grid">
                            <button class="amount-option" data-amount="10">€10</button>
                            <button class="amount-option" data-amount="25">€25</button>
                            <button class="amount-option" data-amount="50">€50</button>
                            <button class="amount-option" data-amount="100">€100</button>
                            <button class="amount-option" data-amount="250">€250</button>
                            <button class="amount-option custom" data-amount="custom">
                                {{ _('Ander bedrag') }}
                            </button>
                        </div>
                    </div>

                    <form method="POST" class="donation-form">
                        <div class="custom-amount-input mb-4" style="display: none;">
                            <label for="custom_amount" class="form-label">{{ _('Voer een bedrag in') }}</label>
                            <div class="input-group">
                                <span class="input-group-text">€</span>
                                <input type="number" class="form-control" id="custom_amount" name="amount" min="1" step="0.01">
                            </div>
                        </div>

                        <div class="mb-4">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="monthly_donation" name="is_monthly">
                                <label class="form-check-label" for="monthly_donation">
                                    {{ _('Maak dit een maandelijkse donatie') }}
                                </label>
                            </div>
                        </div>

                        <div class="personal-info">
                            <div class="mb-3">
                                <label for="donor_name" class="form-label">{{ _('Naam') }}</label>
                                <input type="text" class="form-control" id="donor_name" name="donor_name">
                            </div>
                            <div class="mb-3">
                                <label for="donor_email" class="form-label">{{ _('E-mail') }}</label>
                                <input type="email" class="form-control" id="donor_email" name="donor_email">
                                <div class="form-text">{{ _('Voor donatiebewijs') }}</div>
                            </div>
                            <div class="mb-4">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="is_anonymous" name="is_anonymous">
                                    <label class="form-check-label" for="is_anonymous">
                                        {{ _('Maak mijn donatie anoniem') }}
                                    </label>
                                </div>
                            </div>
                        </div>

                        <div class="payment-methods mb-4">
                            <h4 class="text-center mb-3">{{ _('Kies een betaalmethode') }}</h4>
                            <div class="payment-grid">
                                <div class="payment-option">
                                    <input type="radio" name="payment_method" id="bank_transfer" value="bank_transfer" checked>
                                    <label for="bank_transfer">
                                        <i class="fas fa-university"></i>
                                        <span>{{ _('Bankoverschrijving') }}</span>
                                    </label>
                                </div>
                                <div class="payment-option">
                                    <input type="radio" name="payment_method" id="paypal" value="paypal">
                                    <label for="paypal">
                                        <i class="fab fa-paypal"></i>
                                        <span>PayPal</span>
                                    </label>
                                </div>
                                <div class="payment-option">
                                    <input type="radio" name="payment_method" id="apple_pay" value="apple_pay">
                                    <label for="apple_pay">
                                        <i class="fab fa-apple-pay"></i>
                                        <span>Apple Pay</span>
                                    </label>
                                </div>
                            </div>
                        </div>

                        <div class="d-grid">
                            <button type="submit" class="btn btn-primary btn-lg donation-submit">
                                <i class="fas fa-heart me-2"></i>{{ _('Doneer Nu') }}
                            </button>
                        </div>
                    </form>
                </div>

                <div class="impact-section mt-5">
                    <h3 class="text-center mb-4">{{ _('Uw Impact') }}</h3>
                    <div class="impact-grid">
                        <div class="impact-item">
                            <div class="impact-icon">
                                <i class="fas fa-mosque"></i>
                            </div>
                            <h4>{{ _('Moskeeën') }}</h4>
                            <p>{{ _('Ondersteuning van 21 moskeeën in Gent') }}</p>
                        </div>
                        <div class="impact-item">
                            <div class="impact-icon">
                                <i class="fas fa-graduation-cap"></i>
                            </div>
                            <h4>{{ _('Educatie') }}</h4>
                            <p>{{ _('Islamitisch onderwijs en culturele programma\'s') }}</p>
                        </div>
                        <div class="impact-item">
                            <div class="impact-icon">
                                <i class="fas fa-hands-helping"></i>
                            </div>
                            <h4>{{ _('Gemeenschap') }}</h4>
                            <p>{{ _('Sociale projecten en gemeenschapsactiviteiten') }}</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block styles %}
<style>
:root {
    --primary-color: #005A87;
    --secondary-color: #41B7AC;
    --accent-color: #FF4154;
    --background-light: #F8F9FA;
    --text-primary: #2C3E50;
    --text-secondary: #6C757D;
    --border-color: #E9ECEF;
}

/* Hero Section */
.donate-hero {
    background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
    color: white;
    padding: 8rem 0;
    position: relative;
    overflow: hidden;
    margin-bottom: -4rem;
}

.hero-overlay {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.2);
    z-index: 1;
}

.hero-content {
    position: relative;
    z-index: 2;
    max-width: 800px;
    margin: 0 auto;
}

.hero-content h1 {
    font-weight: 700;
    margin-bottom: 2rem;
    text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

.quote-container {
    background: rgba(255, 255, 255, 0.1);
    backdrop-filter: blur(10px);
    border-radius: 1.5rem;
    padding: 3rem;
    margin-top: 2rem;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
}

.hadith-quote {
    border-left: none;
    padding: 0;
    margin: 0;
}

.lead-quote {
    font-size: 1.5rem;
    font-weight: 300;
    line-height: 1.8;
    margin-bottom: 1rem;
    color: rgba(255, 255, 255, 0.9);
}

.quote-text {
    font-size: 1.25rem;
    line-height: 1.8;
    margin-bottom: 1.5rem;
    font-weight: 300;
    color: rgba(255, 255, 255, 0.9);
}

.quote-source {
    font-size: 1rem;
    opacity: 0.8;
    font-weight: 500;
    font-style: italic;
}

/* Donation Choice Section */
.donation-choice-section {
    padding: 4rem 0;
    background-color: white;
    position: relative;
    z-index: 2;
    margin-bottom: 2rem;
}

.donation-choice-container {
    background: white;
    border-radius: 1rem;
    padding: 2rem;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.05);
}

.choice-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 1.5rem;
    margin-top: 2rem;
}

.choice-option {
    background: white;
    border: 2px solid var(--border-color);
    border-radius: 1rem;
    padding: 2rem;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    gap: 1.5rem;
    text-align: left;
}

.choice-icon {
    font-size: 2rem;
    color: var(--primary-color);
    flex-shrink: 0;
}

.choice-content h3 {
    font-size: 1.25rem;
    color: var(--text-primary);
    margin-bottom: 0.5rem;
}

.choice-content p {
    font-size: 0.9rem;
    color: var(--text-secondary);
    margin: 0;
    line-height: 1.5;
}

.choice-option:hover {
    transform: translateY(-2px);
    border-color: var(--primary-color);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
}

.choice-option.active {
    background: var(--primary-color);
    border-color: var(--primary-color);
    color: white;
}

.choice-option.active .choice-icon,
.choice-option.active h3,
.choice-option.active p {
    color: white;
}

/* Campaigns Section */
.campaigns-section {
    padding: 4rem 0;
    background-color: var(--background-light);
}

/* Updated Project Section Styles */
.projects-widget {
    background: white;
    border-radius: 1.25rem;
    padding: 2rem;
    box-shadow: 0 8px 30px rgba(0, 0, 0, 0.08);
    border: 1px solid rgba(0, 0, 0, 0.05);
}

.widget-title {
    font-size: 2rem;
    font-weight: 700;
    color: var(--text-primary);
    margin-bottom: 2rem;
    text-align: center;
    letter-spacing: -0.02em;
}

.projects-list {
    display: flex;
    flex-direction: column;
    gap: 2rem;
}

.project-item {
    padding: 2rem;
    background: white;
    border-radius: 1rem;
    border: 1px solid var(--border-color);
    transition: all 0.3s ease;
}

.project-item:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
}

.project-header {
    display: flex;
    gap: 2rem;
    margin-bottom: 1.5rem;
}

.project-image {
    width: 200px;
    height: 150px;
    border-radius: 0.75rem;
    overflow: hidden;
    flex-shrink: 0;
}

.project-image img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.project-main-info {
    flex: 1;
}

.project-badge {
    display: inline-block;
    padding: 0.5rem 1rem;
    background: rgba(0, 90, 135, 0.1);
    color: var(--primary-color);
    border-radius: 2rem;
    font-size: 0.875rem;
    font-weight: 500;
    margin-bottom: 1rem;
}

.project-title {
    font-size: 1.5rem;
    font-weight: 600;
    color: var(--text-primary);
    margin-bottom: 1rem;
    line-height: 1.3;
}

.project-description {
    color: var(--text-secondary);
    line-height: 1.6;
    margin-bottom: 0;
}

.project-progress {
    padding: 1.5rem;
    background: var(--background-light);
    border-radius: 1rem;
    margin-bottom: 1.5rem;
}

.progress-stats {
    display: flex;
    justify-content: space-between;
    margin-bottom: 1rem;
}

.progress-stat {
    display: flex;
    flex-direction: column;
    gap: 0.25rem;
}

.stat-label {
    font-size: 0.875rem;
    color: var(--text-secondary);
}

.stat-value {
    font-size: 1.25rem;
    font-weight: 600;
}

.progress {
    height: 10px;
    background-color: rgba(0, 0, 0, 0.05);
    border-radius: 1rem;
    overflow: hidden;
    margin-bottom: 0.75rem;
}

.progress-bar {
    background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
    border-radius: 1rem;
    transition: width 1s cubic-bezier(0.4, 0, 0.2, 1);
}

.progress-percentage {
    text-align: center;
    font-size: 0.875rem;
    color: var(--text-secondary);
    font-weight: 500;
}

.btn-support {
    background: var(--primary-color);
    color: white;
    font-weight: 600;
    padding: 1rem;
    border-radius: 0.75rem;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    border: none;
}

.btn-support:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0, 90, 135, 0.2);
}

@media (max-width: 768px) {
    .project-header {
        flex-direction: column;
        gap: 1rem;
    }

    .project-image {
        width: 100%;
        height: 200px;
    }

    .project-item {
        padding: 1.5rem;
    }

    .project-progress {
        padding: 1.25rem;
    }
}


.section-title {
    font-size: 2.5rem;
    font-weight: 700;
    color: var(--text-primary);
    text-align: center;
    margin-bottom: 0.5rem;
}

.section-subtitle {
    font-size: 1.2rem;
    color: var(--text-secondary);
    text-align: center;
    margin-bottom: 3rem;
}

/* Amount Grid */
.amount-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 1rem;
    margin-bottom: 2rem;
}

.amount-option {
    background: white;
    border: 2px solid var(--border-color);
    border-radius: 0.5rem;
    padding: 1rem;
    font-size: 1.1rem;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
}

.amount-option:hover {
    border-color: var(--primary-color);
    background: var(--background-light);
}

.amount-option.active {
    background: var(--primary-color);
    color: white;
    border-color: var(--primary-color);
}

/* Payment Methods */
.payment-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 1rem;
}

.payment-option {
    position: relative;
}

.payment-option input[type="radio"] {
    position: absolute;
    opacity: 0;
}

.payment-option label {
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 1.5rem;
    border: 2px solid var(--border-color);
    border-radius: 0.5rem;
    cursor: pointer;
    transition: all 0.3s ease;
}

.payment-option label i {
    font-size: 2rem;
    margin-bottom: 0.5rem;
    color: var(--primary-color);
}

.payment-option input[type="radio"]:checked + label {
    border-color: var(--primary-color);
    background: var(--background-light);
}

/* Impact Section */
.impact-section {
    padding: 3rem 0;
}

.impact-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 2rem;
}

.impact-item {
    text-align: center;
}

.impact-icon {
    font-size: 2.5rem;
    color: var(--primary-color);
    margin-bottom: 1rem;
}

.impact-item h4 {
    font-size: 1.2rem;
    margin-bottom: 0.5rem;
    color: var(--text-primary);
}

.impact-item p {
    color: var(--text-secondary);
    font-size: 0.9rem;
    line-height: 1.6;
}

/* Responsive Design */
@media (max-width: 768px) {
    .donate-hero {
        padding: 6rem 0;
    }

    .hero-content h1 {
        font-size: 2rem;
        margin-bottom: 2rem;
    }

    .quote-container {
        padding: 2rem;
        margin-top: 1.5rem;
    }

    .quote-text {
        font-size: 1.1rem;
    }
    .amount-grid,
    .payment-grid,
    .impact-grid {
        grid-template-columns: 1fr;
        gap: 1rem;
    }

    .payment-option label {
        flex-direction: row;
        justify-content: center;
        gap: 1rem;
        padding: 1rem;
    }

    .payment-option label i {
        margin-bottom: 0;
    }
    .choice-grid {
        grid-template-columns: 1fr;
    }

    .choice-option {
        padding: 1.5rem;
    }
}

.bloom-icon {
    display: inline-block;
    margin-left: 0.5rem;
    vertical-align: middle;
    color: rgba(255, 255, 255, 0.9);
}

.bloom-icon .petal {
    transform-origin: center;
    animation: bloomPetal 3s ease-in-out infinite;
}

.bloom-icon .petal-1 { animation-delay: 0s; }
.bloom-icon .petal-2 { animation-delay: 0.2s; }
.bloom-icon .petal-3 { animation-delay: 0.4s; }
.bloom-icon .petal-4 { animation-delay: 0.6s; }

.bloom-icon .center {
    animation: bloomCenter 3s ease-in-out infinite;
}

@keyframes bloomPetal {
    0%, 100% {
        transform: scale(0.8) rotate(0deg);
        opacity: 0.6;
    }
    50% {
        transform: scale(1.2) rotate(15deg);
        opacity: 1;
    }
}

@keyframes bloomCenter {
    0%, 100% {
        transform: scale(0.8);
        opacity: 0.8;
    }
    50% {
        transform: scale(1.1);
        opacity: 1;
    }
}

/* Donation Section */
.donation-section {
    padding: 6rem 0;
    background-color: var(--background-light);
    margin-top: -4rem;
}

.donation-card{
    background: white;
    border-radius: 1rem;
    padding: 2rem;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.05);
}

</style>
{% endblock %}

{% block scripts %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    const choiceOptions = document.querySelectorAll('.choice-option');
    const projectSection = document.getElementById('projectSection');
    const donationFormTitle = document.getElementById('donationFormTitle');

    choiceOptions.forEach(option => {
        option.addEventListener('click', function() {
            choiceOptions.forEach(opt => opt.classList.remove('active'));
            this.classList.add('active');

            const type = this.dataset.type;
            if (type === 'project') {
                projectSection.style.display = 'block';
                donationFormTitle.textContent = 'Kies een project en donatiebedrag';
            } else {
                projectSection.style.display = 'none';
                donationFormTitle.textContent = 'Kies een donatiebedrag';
                document.querySelector('form').dataset.campaignId = '';
            }
        });
    });

    const amountOptions = document.querySelectorAll('.amount-option');
    const customAmountInput = document.querySelector('.custom-amount-input');
    const customAmountField = document.getElementById('custom_amount');

    amountOptions.forEach(option => {
        option.addEventListener('click', function() {
            const amount = this.dataset.amount;
            amountOptions.forEach(opt => opt.classList.remove('active'));
            this.classList.add('active');

            if (amount === 'custom') {
                customAmountInput.style.display = 'block';
                customAmountField.focus();
            } else {
                customAmountInput.style.display = 'none';
                customAmountField.value = amount;
            }
        });
    });

    // Set initial amount
    amountOptions[1].click(); // Select €25 by default
});

function selectCampaign(campaignId, campaignTitle) {
    document.querySelector('form').dataset.campaignId = campaignId;
    const formTitle = document.querySelector('#donationFormTitle');
    formTitle.textContent = `Steun: ${campaignTitle}`;
    document.querySelector('.donation-section').scrollIntoView({ behavior: 'smooth' });
}

document.querySelector('form').addEventListener('submit', function(e) {
    const campaignId = this.dataset.campaignId;
    if (campaignId) {
        const input = document.createElement('input');
        input.type = 'hidden';
        input.name = 'campaign_id';
        input.value = campaignId;
        this.appendChild(input);
    }
});

function updateCampaignProgress(campaignId) {
    fetch(`/api/campaigns/${campaignId}/status`)
        .then(response => response.json())
        .then(data => {
            const card = document.querySelector(`[data-campaign-id="${campaignId}"]`);
            const progressBar = card.querySelector('.progress-bar');
            const progressText = card.querySelector('.progress-percentage');
            const amountText = card.querySelector('.progress-amount');

            progressBar.style.width = `${data.progress}%`;
            progressBar.setAttribute('aria-valuenow', data.progress);
            progressText.textContent = `${data.progress.toFixed(1)}% bereikt`;
            amountText.textContent = `€${data.current_amount.toFixed(2)}`;

            progressBar.classList.add('progress-updated');
            setTimeout(() => progressBar.classList.remove('progress-updated'), 1000);
        });
}

// Update all campaign progress bars every 30 seconds
document.querySelectorAll('.campaign-card').forEach(card => {
    const campaignId = card.dataset.campaignId;
    setInterval(() => updateCampaignProgress(campaignId), 30000);
});
</script>

<style>
@keyframes progressPulse {
    0% { opacity: 0.7; }
    50% { opacity: 1; }
    100% { opacity: 0.7; }
}

.progress-updated {
    animation: progressPulse 1s ease-in-out;
}
</style>
{% endblock %}